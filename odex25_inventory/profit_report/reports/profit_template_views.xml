<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="custom_header">
        <div class="header">
            <table class="table table-borderless" style="border: none; width: 100%;" dir="ltr">
                <tbody>
                    <tr>
                        <td colspan="8">
                            <div>
                                <span style="font-weight: bold;">Report:</span>
                                <span>Profit Report</span>
                            </div>
                            <div>
                                <span style="font-weight: bold;">Date from:</span>
                                <span t-esc="report_data and report_data.get('date_from')"/>
                            </div>
                            <div>
                                <span style="font-weight: bold;">Date to:</span>
                                <span t-esc="report_data and report_data.get('date_to')"/>
                            </div>
                            <div>
                                <span style="font-weight: bold;">Currency:</span>
                                <span>SR</span>
                            </div>
                        </td>
                        <td colspan="4" style="text-align: right;">
                            <img src='/bill_product_report/static/img/logo.png' width="120px"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </template>

    <template id="profit_report_html">
        <t t-call="web.html_container">
            <t t-call="bill_product_report.custom_header"/>

            <div class="page">
                <table class="table table-sm table-bordered"
                       style="width:100%; border: 1px solid black; text-align: center;">
                    <thead style="background-color: #f0f0f0; font-weight: bold;">
                        <tr style="border: 1px solid black;">
                            <th style="border: 1px solid black;" rowspan="2">Product Category</th>
                            <th style="border: 1px solid black;" rowspan="2">Default Code</th>
                            <th style="border: 1px solid black;" rowspan="2">Product</th>

                            <!-- Last Year -->
                            <th style="border: 1px solid black; background-color: #27C2F5;" colspan="6">
                                Last Year (
                                <t t-esc="date_from_last_year"/>
                                →<t t-esc="date_to_last_year"/>)
                            </th>

                            <!-- Current Period -->
                            <th style="border: 1px solid black; background-color: #27F5C1;" colspan="6">
                                Current Period (
                                <t t-esc="report_data.get('date_from')"/>
                                →<t t-esc="report_data.get('date_to')"/>)
                            </th>
                        </tr>

                        <tr style="border: 1px solid black;">
                            <!-- Sub headers for Last Year -->
                            <th style="border: 1px solid black; background-color: #27C2F5;">Total Quantity</th>
                            <th style="border: 1px solid black; background-color: #27C2F5;">Total Price</th>
                            <th style="border: 1px solid black; background-color: #27C2F5;">NASP</th>
                            <th style="border: 1px solid black; background-color: #27C2F5;">NAPP</th>
                            <th style="border: 1px solid black; background-color: #27C2F5;">Profit Value</th>
                            <th style="border: 1px solid black; background-color: #27C2F5;">Profit Margin</th>

                            <!-- Sub headers for Current Period -->
                            <th style="border: 1px solid black; background-color: #27F5C1;">Total Quantity</th>
                            <th style="border: 1px solid black; background-color: #27F5C1;">Total Price</th>
                            <th style="border: 1px solid black; background-color: #27F5C1;">NASP</th>
                            <th style="border: 1px solid black; background-color: #27F5C1;">NAPP</th>
                            <th style="border: 1px solid black; background-color: #27F5C1;">Profit Value</th>
                            <th style="border: 1px solid black; background-color: #27F5C1;">Profit Margin</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="last_category" t-value="None"/>
                        <t t-foreach="(report_data or {}).get('product_ids', [])" t-as="line">
                            <tr style="border: 1px solid black;">
                                <!-- Product Category -->
                                <td style="border: 1px solid black;">
                                    <t t-if="line['Product Category'] != last_category">
                                        <t t-esc="line['Product Category']"/>
                                        <t t-set="last_category" t-value="line['Product Category']"/>
                                    </t>
                                </td>
                                <!-- Default Code -->
                                <td style="border: 1px solid black;">
                                    <t t-esc="line['Default Code']"/>
                                </td>

                                <!-- Product -->
                                <td style="border: 1px solid black;">
                                    <t t-esc="line['Product']"/>
                                </td>

                                <!-- Last Year Total Quantity -->
                                <td style="border: 1px solid black;">
                                    <t t-esc="line['Last Year Total Quantity']"/>
                                </td>

                                <!-- Last Year Total Price -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Last Year Total Price']"/>
                                </td>

                                <!-- Last Year Nsap -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Last Year Nsap']"/>
                                </td>

                                  <!-- Last Year Naap -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Last Year Naap']"/>
                                </td>

                                <!-- Last Profit Value -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Last Profit Value']"/>
                                </td>
                                <!-- Last Margin -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Last Margin']"/>
                                </td>

                                <!-- Total Quantity -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Total Quantity']"/>
                                </td>
                                <!-- Total Price -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Total Price']"/>
                                </td>
                                <!-- Nsap -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Nsap']"/>
                                </td>
                                <!-- Naap -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Naap']"/>
                                </td>
                                 <!-- Profit Value -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Profit Value']"/>
                                </td>
                                <!-- Margin -->
                                <td style="border: 1px solid black; text-align: center;">
                                    <t t-esc="line['Margin']"/>
                                </td>

                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>
    </template>

</odoo>
